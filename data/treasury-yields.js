// Historical treasury yield curve data from 1970 to present
// Yields are approximate averages for the period, in decimal format (e.g., 0.05 = 5%)

const yieldCurveData = {
  // 1970s - High inflation era
  1970: { '3M': 0.0651, '6M': 0.0678, '1Y': 0.0707, '2Y': 0.0724, '5Y': 0.0750, '10Y': 0.0761, '30Y': 0.0774 },
  1971: { '3M': 0.0440, '6M': 0.0464, '1Y': 0.0498, '2Y': 0.0538, '5Y': 0.0601, '10Y': 0.0629, '30Y': 0.0645 },
  1972: { '3M': 0.0407, '6M': 0.0431, '1Y': 0.0467, '2Y': 0.0530, '5Y': 0.0601, '10Y': 0.0636, '30Y': 0.0652 },
  1973: { '3M': 0.0703, '6M': 0.0755, '1Y': 0.0727, '2Y': 0.0669, '5Y': 0.0665, '10Y': 0.0684, '30Y': 0.0698 },
  1974: { '3M': 0.0779, '6M': 0.0802, '1Y': 0.0792, '2Y': 0.0773, '5Y': 0.0767, '10Y': 0.0774, '30Y': 0.0784 },
  1975: { '3M': 0.0588, '6M': 0.0625, '1Y': 0.0662, '2Y': 0.0708, '5Y': 0.0778, '10Y': 0.0817, '30Y': 0.0843 },
  1976: { '3M': 0.0499, '6M': 0.0541, '1Y': 0.0591, '2Y': 0.0646, '5Y': 0.0716, '10Y': 0.0769, '30Y': 0.0791 },
  1977: { '3M': 0.0512, '6M': 0.0547, '1Y': 0.0593, '2Y': 0.0638, '5Y': 0.0710, '10Y': 0.0759, '30Y': 0.0781 },
  1978: { '3M': 0.0719, '6M': 0.0770, '1Y': 0.0826, '2Y': 0.0861, '5Y': 0.0873, '10Y': 0.0884, '30Y': 0.0893 },
  1979: { '3M': 0.1014, '6M': 0.1016, '1Y': 0.1006, '2Y': 0.0991, '5Y': 0.0967, '10Y': 0.0963, '30Y': 0.0963 },
  
  // 1980s - Peak interest rates then decline
  1980: { '3M': 0.1143, '6M': 0.1165, '1Y': 0.1177, '2Y': 0.1182, '5Y': 0.1165, '10Y': 0.1168, '30Y': 0.1174 },
  1981: { '3M': 0.1412, '6M': 0.1407, '1Y': 0.1384, '2Y': 0.1373, '5Y': 0.1378, '10Y': 0.1397, '30Y': 0.1408 },
  1982: { '3M': 0.1071, '6M': 0.1113, '1Y': 0.1157, '2Y': 0.1216, '5Y': 0.1288, '10Y': 0.1346, '30Y': 0.1384 },
  1983: { '3M': 0.0862, '6M': 0.0903, '1Y': 0.0954, '2Y': 0.1020, '5Y': 0.1092, '10Y': 0.1137, '30Y': 0.1164 },
  1984: { '3M': 0.0952, '6M': 0.1004, '1Y': 0.1053, '2Y': 0.1127, '5Y': 0.1214, '10Y': 0.1275, '30Y': 0.1307 },
  1985: { '3M': 0.0754, '6M': 0.0781, '1Y': 0.0814, '2Y': 0.0883, '5Y': 0.0989, '10Y': 0.1079, '30Y': 0.1128 },
  1986: { '3M': 0.0609, '6M': 0.0621, '1Y': 0.0637, '2Y': 0.0679, '5Y': 0.0758, '10Y': 0.0837, '30Y': 0.0887 },
  1987: { '3M': 0.0582, '6M': 0.0621, '1Y': 0.0661, '2Y': 0.0721, '5Y': 0.0820, '10Y': 0.0895, '30Y': 0.0933 },
  1988: { '3M': 0.0654, '6M': 0.0704, '1Y': 0.0754, '2Y': 0.0814, '5Y': 0.0895, '10Y': 0.0944, '30Y': 0.0972 },
  1989: { '3M': 0.0836, '6M': 0.0847, '1Y': 0.0851, '2Y': 0.0860, '5Y': 0.0882, '10Y': 0.0901, '30Y': 0.0916 },
  
  // 1990s - Generally declining rates
  1990: { '3M': 0.0774, '6M': 0.0777, '1Y': 0.0781, '2Y': 0.0814, '5Y': 0.0851, '10Y': 0.0876, '30Y': 0.0894 },
  1991: { '3M': 0.0554, '6M': 0.0572, '1Y': 0.0598, '2Y': 0.0658, '5Y': 0.0738, '10Y': 0.0793, '30Y': 0.0826 },
  1992: { '3M': 0.0351, '6M': 0.0371, '1Y': 0.0410, '2Y': 0.0483, '5Y': 0.0615, '10Y': 0.0706, '30Y': 0.0761 },
  1993: { '3M': 0.0301, '6M': 0.0316, '1Y': 0.0349, '2Y': 0.0416, '5Y': 0.0532, '10Y': 0.0588, '30Y': 0.0632 },
  1994: { '3M': 0.0426, '6M': 0.0481, '1Y': 0.0545, '2Y': 0.0638, '5Y': 0.0731, '10Y': 0.0770, '30Y': 0.0793 },
  1995: { '3M': 0.0560, '6M': 0.0577, '1Y': 0.0592, '2Y': 0.0609, '5Y': 0.0639, '10Y': 0.0665, '30Y': 0.0687 },
  1996: { '3M': 0.0514, '6M': 0.0533, '1Y': 0.0563, '2Y': 0.0598, '5Y': 0.0639, '10Y': 0.0664, '30Y': 0.0683 },
  1997: { '3M': 0.0519, '6M': 0.0543, '1Y': 0.0571, '2Y': 0.0597, '5Y': 0.0632, '10Y': 0.0648, '30Y': 0.0664 },
  1998: { '3M': 0.0497, '6M': 0.0509, '1Y': 0.0524, '2Y': 0.0544, '5Y': 0.0568, '10Y': 0.0563, '30Y': 0.0571 },
  1999: { '3M': 0.0468, '6M': 0.0495, '1Y': 0.0529, '2Y': 0.0580, '5Y': 0.0604, '10Y': 0.0598, '30Y': 0.0607 },
  
  // 2000s - Tech bubble burst, then housing crisis
  2000: { '3M': 0.0589, '6M': 0.0620, '1Y': 0.0647, '2Y': 0.0658, '5Y': 0.0648, '10Y': 0.0607, '30Y': 0.0584 },
  2001: { '3M': 0.0353, '6M': 0.0354, '1Y': 0.0361, '2Y': 0.0396, '5Y': 0.0487, '10Y': 0.0507, '30Y': 0.0545 },
  2002: { '3M': 0.0166, '6M': 0.0180, '1Y': 0.0203, '2Y': 0.0265, '5Y': 0.0379, '10Y': 0.0461, '30Y': 0.0523 },
  2003: { '3M': 0.0105, '6M': 0.0111, '1Y': 0.0125, '2Y': 0.0181, '5Y': 0.0312, '10Y': 0.0401, '30Y': 0.0486 },
  2004: { '3M': 0.0135, '6M': 0.0163, '1Y': 0.0210, '2Y': 0.0283, '5Y': 0.0374, '10Y': 0.0427, '30Y': 0.0491 },
  2005: { '3M': 0.0316, '6M': 0.0357, '1Y': 0.0395, '2Y': 0.0406, '5Y': 0.0416, '10Y': 0.0429, '30Y': 0.0460 },
  2006: { '3M': 0.0487, '6M': 0.0503, '1Y': 0.0508, '2Y': 0.0484, '5Y': 0.0473, '10Y': 0.0477, '30Y': 0.0489 },
  2007: { '3M': 0.0463, '6M': 0.0488, '1Y': 0.0488, '2Y': 0.0453, '5Y': 0.0450, '10Y': 0.0463, '30Y': 0.0480 },
  2008: { '3M': 0.0143, '6M': 0.0186, '1Y': 0.0272, '2Y': 0.0308, '5Y': 0.0346, '10Y': 0.0366, '30Y': 0.0423 },
  2009: { '3M': 0.0015, '6M': 0.0027, '1Y': 0.0047, '2Y': 0.0103, '5Y': 0.0226, '10Y': 0.0326, '30Y': 0.0408 },
  
  // 2010s - Low rate environment
  2010: { '3M': 0.0014, '6M': 0.0018, '1Y': 0.0027, '2Y': 0.0062, '5Y': 0.0204, '10Y': 0.0328, '30Y': 0.0415 },
  2011: { '3M': 0.0005, '6M': 0.0008, '1Y': 0.0015, '2Y': 0.0026, '5Y': 0.0090, '10Y': 0.0278, '30Y': 0.0394 },
  2012: { '3M': 0.0010, '6M': 0.0013, '1Y': 0.0016, '2Y': 0.0028, '5Y': 0.0078, '10Y': 0.0178, '30Y': 0.0294 },
  2013: { '3M': 0.0006, '6M': 0.0008, '1Y': 0.0011, '2Y': 0.0031, '5Y': 0.0135, '10Y': 0.0252, '30Y': 0.0365 },
  2014: { '3M': 0.0003, '6M': 0.0005, '1Y': 0.0009, '2Y': 0.0045, '5Y': 0.0166, '10Y': 0.0253, '30Y': 0.0331 },
  2015: { '3M': 0.0003, '6M': 0.0021, '1Y': 0.0032, '2Y': 0.0067, '5Y': 0.0155, '10Y': 0.0227, '30Y': 0.0297 },
  2016: { '3M': 0.0027, '6M': 0.0050, '1Y': 0.0060, '2Y': 0.0084, '5Y': 0.0143, '10Y': 0.0184, '30Y': 0.0260 },
  2017: { '3M': 0.0094, '6M': 0.0119, '1Y': 0.0133, '2Y': 0.0148, '5Y': 0.0194, '10Y': 0.0233, '30Y': 0.0289 },
  2018: { '3M': 0.0193, '6M': 0.0226, '1Y': 0.0240, '2Y': 0.0259, '5Y': 0.0280, '10Y': 0.0290, '30Y': 0.0307 },
  2019: { '3M': 0.0208, '6M': 0.0213, '1Y': 0.0200, '2Y': 0.0177, '5Y': 0.0183, '10Y': 0.0215, '30Y': 0.0266 },
  
  // 2020s - COVID and beyond
  2020: { '3M': 0.0018, '6M': 0.0015, '1Y': 0.0014, '2Y': 0.0016, '5Y': 0.0036, '10Y': 0.0089, '30Y': 0.0154 },
  2021: { '3M': 0.0004, '6M': 0.0005, '1Y': 0.0007, '2Y': 0.0028, '5Y': 0.0093, '10Y': 0.0146, '30Y': 0.0195 },
  2022: { '3M': 0.0226, '6M': 0.0312, '1Y': 0.0393, '2Y': 0.0384, '5Y': 0.0336, '10Y': 0.0302, '30Y': 0.0318 },
  2023: { '3M': 0.0523, '6M': 0.0536, '1Y': 0.0534, '2Y': 0.0468, '5Y': 0.0423, '10Y': 0.0391, '30Y': 0.0403 },
  2024: { '3M': 0.0520, '6M': 0.0515, '1Y': 0.0490, '2Y': 0.0440, '5Y': 0.0410, '10Y': 0.0420, '30Y': 0.0445 }
};

// Get yield for a specific maturity at a given date
function getYield(date, maturity) {
  const year = date.getFullYear();
  const yearData = yieldCurveData[year];
  
  if (!yearData) {
    // If no data for that year, find nearest year
    const years = Object.keys(yieldCurveData).map(Number).sort((a, b) => a - b);
    const nearestYear = years.reduce((prev, curr) => 
      Math.abs(curr - year) < Math.abs(prev - year) ? curr : prev
    );
    return yieldCurveData[nearestYear][maturity] || 0.05;
  }
  
  return yearData[maturity] || 0.05;
}

// Get entire yield curve for a given date
function getYieldCurve(date) {
  const year = date.getFullYear();
  const yearData = yieldCurveData[year];
  
  if (!yearData) {
    const years = Object.keys(yieldCurveData).map(Number).sort((a, b) => a - b);
    const nearestYear = years.reduce((prev, curr) => 
      Math.abs(curr - year) < Math.abs(prev - year) ? curr : prev
    );
    return yieldCurveData[nearestYear];
  }
  
  return yearData;
}

// Map bond maturity to yield curve maturity
function getMaturityKey(bond) {
  if (bond.maturityWeeks) {
    const weeks = bond.maturityWeeks;
    if (weeks <= 13) return '3M';
    if (weeks <= 26) return '6M';
    return '1Y';
  }
  
  if (bond.maturityYears) {
    const years = bond.maturityYears;
    if (years <= 1) return '1Y';
    if (years <= 2) return '2Y';
    if (years <= 5) return '5Y';
    if (years <= 10) return '10Y';
    return '30Y';
  }
  
  return '10Y'; // Default
}

module.exports = {
  yieldCurveData,
  getYield,
  getYieldCurve,
  getMaturityKey
};
